PHASE1 BASE EXEMPLE

																	SELECT
ex1 Afficher toutes les informations concernant les employés

SELECT *
FROM employe ;


ex2 Afficher toutes les informations concernant les départements.

SELECT *
FROM dept ;


ex3 Afficher le nom, la date d'embauche, le numéro du supérieur, le numéro de département et le salaire de tous les employés.

SELECT nom, dateemb, nosup, nodep, salaire
FROM employe ;


																SUPPR DOUBLONS avec distinct
ex4 Afficher le titre de tous les employés. 

SELECT titre
FROM employe ;


ex 5 Afficher les différentes valeurs des titres des employés. 

SELECT distinct titre
FROM employe ;


																RESTRICTIONS avec where
ex6 Afficher le nom, le numéro d' employé et le numéro du département des employés dont le titre est «Secrétaire». 

SELECT nom, noemploye, nodep
FROM employe
WHERE titre = 'Secrétaire' ;


ex7 Afficher le nom et le numéro de département dont le numéro de département est supérieur à 40.

SELECT nom, nodept
FROM dept
WHERE nodept > 40 ;


ex8 Afficher le nom et le prénom des employés dont le nom est alphabétiquement antérieur au prénom. 

SELECT nom, prenom
FROM employe
WHERE nom < prenom ;
 
ex 9 Afficher le nom, le salaire et le numéro du département des employés dont le titre est «Représentant», le numéro de département est 35et le salaire est supérieur à 20000. 

SELECT nom, salaire, nodep
FROM employe
WHERE titre = 'Représentant'
AND nodep = 35
AND salaire > 20000 ;


ex10 Afficher le nom, le titre et le salaire des employés dont le titre est «Représentant» ou dont le titre est «Président». 

SELECT nom, titre, salaire
FROM employe
WHERE titre = 'Représentant'
OR titre = 'Président' ;


ex11 Afficher le nom, le titre, le numéro de département, le salaire des employés du département 34, dont le titre est «Représentant» ou «Secrétaire». 

SELECT nom, titre, nodep, salaire
FROM employe
WHERE (titre = 'Représentant' OR titre = 'Secrétaire')
	AND nodep = 34 ;


ex12 Afficher le nom, le titre, le numéro de département, le salaire des employés dont le titre est Représentant, ou dont le titre est Secrétaire dans le département numéro 34. 

SELECT nom, titre, nodep, salaire
FROM employe
WHERE titre = 'Représentant'
	OR (titre = 'Secrétaire' AND nodep = 34) ;


ex13 Afficher le nom, et le salaire des employés dont le salaire est compris entre 20 000 et 30 000. 

SELECT nom, salaire
FROM employe
WHERE salaire >= 20000 AND salaire <= 30000 ;

/*possibilité d’écrire avec between */


ex14 

ex15 Afficher le nom des employés commençant par la lettre «H». 

SELECT nom
FROM employe
WHERE nom LIKE 'H%' ;


ex16 Afficher le nom des employés se terminant par la lettre «n». 

SELECT nom
FROM employe
WHERE NOM LIKE '%n' ;
 
ex17 Afficher le nom des employés contenant la lettre «u» en 3èmeposition.

SELECT NOM
FROM EMPLOYE
WHERE NOM LIKE '__u%' ;


ex18 Afficher le salaire et le nom des employés du service 41 classés par salaire croissant. 

SELECT salaire, nom
FROM employe
WHERE nodep = 41
ORDER BY salaire ;


ex19 Afficher le salaire et le nom des employés du service 41classés par salaire décroissant. 

SELECT salaire, nom
FROM employe
WHERE nodep = 41
ORDER BY salaire DESC ;


ex20 Afficher le titre, le salaire et le nom des employés classés par titre croissant et par salaire décroissant.

SELECT titre, salaire, nom
FROM employe
ORDER BY titre, salaire desc ;


																VALEURS NON RENSEIGNEES
ex21 Afficher le taux de commission, le salaire et le nom des employés classés par taux de commission croissante. Si on veut utiliser les valeurs non renseignées dans une restriction ce sera avec les clauses IS NULL ou IS NOT NULL. 

SELECT tx_commission, salaire, nom
FROM employe
ORDER BY tx_commission ;


ex22 Afficher le nom, le salaire, le taux de commission et le titre des employés dont le taux de commission n'est pas renseigné. 

SELECT nom, salaire, tx_commission, titre
FROM employe
WHERE tx_commission IS NULL ;


ex23 Afficher le nom, le salaire, le taux de commission et le titre des employés dont le taux de commission est renseigné. 

SELECT nom, salaire, tx_commission, titre
FROM employe
WHERE tx_commission IS NOT NULL ;


 
ex24 Afficher le nom, le salaire, le taux de commission, le titre des employés dont le taux de commission est inférieur à 15. 

SELECT nom, salaire, tx_commission, titre
FROM employe
WHERE tx_commission < 15 ;


ex25 Afficher le nom, le salaire, le taux de commission, le titre des employés dont le taux de commission est supérieur à 15

SELECT nom, salaire, tx_commission, titre
FROM employe
WHERE tx_commission > 15 ;


																			EXPRESSIONS ARITHMETIQUES
ex26 Afficher le nom, le salaire, le taux de commission et la commission des employés dont le taux de commission n'est pas nul.(la commission est calculée en multipliant le salaire par le taux de commission)

SELECT nom, salaire, tx_commission, salaire * tx_commission/100
FROM employe
WHERE tx_commission IS NOT NULL ;


ex27 Afficher le nom, le salaire, le taux de commission, la commission des employés dont le taux de commission n'est pas nul, classé par taux de commission croissant

SELECT nom, salaire, tx_commission, salaire * tx_commission/100
FROM employe
WHERE tx_commission IS NOT NULL
ORDER BY 3 ;


																			CONCATENATION
ex28 Afficher le nom et le prénom (concaténés) des employés. Renommer les colonnes

SELECT CONCAT (nom, ' ', prenom)
FROM employe ;



																			CHAINES DE CARACTERES
ex29 Afficher les 5 premières lettres du nom des employés 

SELECT nom, SUBSTRING(nom, 1, 5)
FROM employe ;


ex30 Afficher le nom et le rang de la lettre «r» dans le nom des employés. 

SELECT nom, LOCATE('r', nom)
FROM employe ;

 
ex31 Afficher le nom, le nom en majuscule et le nom en minuscule de l'employé dont le nom est Vrante. 

SELECT nom, UPPER(nom), LOWER(nom)
FROM employe
WHERE nom = 'Vrante' ;


ex32 Afficher le nom et le nombre de caractères du nom des employés.

SELECT nom, LENGTH(nom)
FROM employe ;
 
																		III LES BESOINS D’AFFICHAGE

ex1 Quelles sont les commandes du fournisseur 09120 ?

select *
from entcom
where numfou = 09120;


ex2 Afficher le code des fournisseurs pour lesquels des commandes ont été passées.

select *
from entcom;


ex3 Afficher le nombre de commandes fournisseurs passées, et le nombre de fournisseur concernés

select count(*) AS 'nb cdes', count(numfou) AS 'nb fss'
from entcom
where obscom != ' ';


ex4 Editer les produits ayant un stock inférieur ou égal au stock d'alerte et dont la quantité annuelle est inférieure à 1000
(informations à fournir : n° produit, libelléproduit, stock, stockactuel d'alerte, quantitéannuelle)

select codart, libart, stkphy, stkale, qteann
from produit
where stkphy <= stkale
and qteann < 1000 ;


ex5 Quels sont les fournisseurs situés dans les départements 75, 78, 92, 77 ? 
L’affichage (département, nom fournisseur) sera effectué par département décroissant, puis par ordre alphabétique

select posfou, nomfou
from fournis
where left (posfou, 2) in (75,78, 92, 77)
order by posfou desc, nomfou; 


ex6 Quelles sont les commandes passées au mois de mars et avril?

select substring(datcom, 6, 2), numcom
from entcom
where substring(datcom, 6, 2)=03 or 04;


ex7 Quelles sont les commandes du jour qui ont des observations particulières ?
(Affichage numéro de commande, date de commande)

select numcom, datcom, obscom
from entcom
where obscom != "";


ex8 Lister le total de chaque commande par total décroissant 
(Affichage numéro de commande et total)

select numcom, qtecde*priuni AS total
from ligcom
order by total desc;


ex9 Lister les commandes dont le total est supérieur à 10 000€; 
on exclura dans le calcul du total les articles commandés en quantité supérieure ou égale à 1 000.
(Affichage numéro de commande et total)

select numcom, qtecde*priuni AS total
from ligcom
where qtecde*priuni > 10000
and qtecde < 1000;


ex10 Lister les commandes par nom fournisseur 
(Afficher le nom du fournisseur, le numéro de commande et la date)

select nomfou, numcom, datcom
from fournis
join entcom
on fournis.numfou = entcom.numfou;


ex11 Sortir les produits des commandes ayant le mot "urgent' en observation
(Afficher le numéro de commande, le nom du fournisseur, le libellé du produit et le sous total = quantité commandée * Prix unitaire)

select entcom.numcom, nomfou, libart, qtecde*priuni AS soustotal, obscom
from fournis
natural join entcom
natural join ligcom
natural join produit
where obscom like "%urgent%";


ex12 Coder de 2 manières différentes la requête suivante :
Lister le nom des fournisseurs susceptibles de livrer au moins un article

#1
select distinct nomfou
from fournis
natural join entcom
natural join ligcom
where qteliv >= 1;

#2
select distinct nomfou
from fournis
natural join entcom
natural join ligcom
where qteliv !=0 and qteliv is not null; 
ex13 Coder de 2 manières différentes la requête suivante :
Lister les commandes (Numéro et date) dont le fournisseur est celui de la commande 70210

#1
select numcom, datcom
from entcom
where numfou =
(select numfou
from entcom
	where numcom = 70210);

#2
xxxxxxx



ex14 Dans les articles susceptibles d’être vendus, lister les articles moins chers (basés sur Prix1) que le moins cher des rubans (article dont le premier caractère commence par R). 
On affichera le libellé de l’article et prix1

select libart, priuni
from ligcom
natural join produit
natural join vente
order by priuni
and priuni <
(select min(prix1)
from produit
natural join vente
	where libart like 'r%');


ex15 Editer la liste des fournisseurs susceptibles de livrer les produits dont le stock est inférieur ou égal à 150 % du stock d'alerte. 
La liste est triée par produit puis fournisseur

select libart, nomfou
from produit
natural join vente
natural join fournis
where stkphy <= 150/100*stkale
order by libart, nomfou;


ex16 Éditer la liste des fournisseurs susceptibles de livrer les produit dont le stock est inférieur ou égal à 150 % du stock d'alerte et un délai de livraison d'au plus 30 jours. 
La liste est triée par fournisseur puis produit

select libart, nomfou
from produit
natural join vente
natural join fournis
where stkphy <= 150/100*stkale
and delliv <= 30
order by nomfou, libart;
 
ex17 Avec le même type de sélection que ci-dessus, sortir un total des stocks par fournisseur trié par total décroissant

select nomfou, sum(stkphy)
from produit
natural join vente
natural join fournis
group by nomfou
order by sum(stkphy) desc;


ex18 En fin d'année, sortir la liste des produits dont la quantité réellement commandée dépasse 90% de la quantité annuelle prévue.

select libart, qte1+qte2+qte3 AS "qtés réellement commandées", qteann
from produit
natural join vente
where qte1+qte2+qte3 > 90/100*qteann;


ex19 Calculer le chiffre d'affaire par fournisseur pour l'année 93 sachant que les prix indiqués sont hors
taxes et que le taux de TVA est 20%.

select nomfou, sum((qte1*prix1+qte2*prix2+qte3*prix3)*1.20) AS "chiffre d'affaires"
from vente
natural join fournis
natural join entcom
natural join ligcom
group by nomfou
order by sum((qte1*prix1+qte2*prix2+qte3*prix3)*1.20) desc; 


 
																			IV LES BESOINS DE MISE A JOUR

ex1 Application d'une augmentation de tarif de 4% pour le prix 1, 2% pour le prix2 pour le fournisseur 9180

update vente
set prix1 = prix1*1.04, prix2 = prix2*1.02
where numfou = 9180;


ex2 Dans la table vente, mettre à jour le prix2 des articles dont le prix2 est null, en affectant une valeur de prix

update vente
set prix2 = 111
where prix2 = 0;


ex3 Mettre à jour le champ obscom en positionnant '*****' pour toutes les commandes dont le fournisseur a un indice de satisfaction < 5.

update entcom
natural join fournis
set obscom = '*****'
where satisf < 5;


ex4 Suppression du produit I110

delete from vente /*d'abord clé étrangère*/
where codart = 'I110';

delete from produit /*puis table en clé primaire*/
where codart = 'I110';


